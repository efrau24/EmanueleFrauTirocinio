version: "3.1"

rules:

# regole di saluto

- rule: Saluto dopo completamento form
  condition:
    - slot_was_set:
        - form_completato: true
  steps:
    - intent: saluto
    - action: utter_saluto_personalizzato

- rule: Risposta a arrivederci
  steps:
    - intent: arrivederci
    - action: utter_arrivederci



# regole form 

- rule: Avvia form all'inizio della conversazione
  steps:
    - intent: saluto
    - action: utter_saluto_iniziale
    - action: action_conversazione_avviata
    - action: form_informazioni_utente
    - active_loop: form_informazioni_utente

- rule: Completamento form informazioni iniziali utente
  condition:
    - active_loop: form_informazioni_utente
  steps:
    - action: form_informazioni_utente
    - active_loop: null
    - slot_was_set:
        - requested_slot: null
    - action: action_submit_form_informazioni_utente



- rule: Utente rifiuta di dare informazioni
  steps:
    - intent: rifiuto
    - action: utter_ok_niente_domande


# regole di conversazione

- rule: Risposta a grazie
  steps:
    - intent: grazie
    - action: utter_prego


# regole azioni personalizzate

- rule: Classifica topic da messaggio generico
  steps:
    - intent: messaggio_generico
    - action: action_classifica_topic


- rule: LLM fallback se non classificabile
  steps:
    - intent: nlu_fallback
    - action: action_llm_fallback

- rule: Classifica talk type
  steps:
    - intent: messaggio_MI
    - action: action_classifica_talk_type

